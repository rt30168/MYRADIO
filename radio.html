<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Radio Italiane</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
body{{font-family:Arial,Helvetica,sans-serif;background:#111;color:#fff;margin:0;padding:20px}}
h1{{text-align:center;color:#ffeb3b;margin-top:10px;margin-bottom:30px}}
.radio-grid{{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;justify-items:center;text-align:center}}
.radio-button{{padding:12px 15px;font-size:16px;border-radius:8px;border:1px solid #ccc;cursor:pointer;background:#333;color:#fff;transition:background .3s,color .3s;width:100%}}
.radio-button.active{{background:#ffeb3b;color:#000;font-weight:700}}
#stopBtn{{margin-top:10px;padding:10px 20px;font-size:16px;border-radius:8px;border:1px solid #ccc;background:#333;color:#fff;cursor:pointer;transition:background .3s,color .3s}}
#stopBtn:hover{{background:#ffeb3b;color:#000}}
#audioPlayer{{width:90%;max-width:500px;margin-top:20px}}
#playerContainer{{text-align:center;margin-top:30px}}
#debug{{font-size:13px;color:#9c9;text-align:center;margin-top:10px;opacity:0;transition:opacity 0.5s ease}}
</style>
</head>
<body>
<h1>Ascolta le tue Radio</h1>
<div class="radio-grid">
<button class="radio-button" onclick="playRadio(this, "http://streamcdnb1-4c4b867c89244861ac216426883d1ad0.msvdn.net/radiodeejay/radiodeejay/play1.m3u8")">Radio Deejay</button>
<button class="radio-button" onclick="playRadio(this, "https://StreamCdnF42-4c4b867c89244861ac216426883d1ad0.msvdn.net/radiodeejay30songs/radiodeejay30songs/master_ma.m3u8")">Deejay 30 Songs</button>
<button class="radio-button" onclick="playRadio(this, "https://streamingv2.shoutcast.com/rtl-1025-best")">RTL 102.5 Best</button>
<button class="radio-button" onclick="playRadio(this, "http://icy.unitedradio.it/VirginRockClassics.mp3")">Virgin Radio Classic Rock</button>
<button class="radio-button" onclick="playRadio(this, "https://stream6.xdevel.com/audio4s975355-395/stream/icecast.audio")">Radio Bruno</button>
<button class="radio-button" onclick="playRadio(this, "https://radioitaliasmi.akamaized.net/hls/live/2093120/RISMI/stream01/streamPlaylist.m3u8")">Radio Italia Solo Musica Italiana</button>
<button class="radio-button" onclick="playRadio(this, "http://shoutcast2.radio24.it:8000/;")">Radio 24 il sole 24 ore</button>
<button class="radio-button" onclick="playRadio(this, "http://wma01.fluidstream.net/marilu")">Radio Maril√π</button>
<button class="radio-button" onclick="playRadio(this, "http://icy.unitedradio.it/105Dance90.mp3")">Radio 105 - Dance 90</button>
<button class="radio-button" onclick="playRadio(this, "https://redbeemedia.streamabc.net/redbm-rtv80-mp3-192-4673332?sABC=68s504n5%230%234313or3p195706q13n90589o7061s597%23aycb&aw_0_1st.playerid=nlpo&amsparams=playerid:nlpo;skey:1760887973")">Radio 80</button>
<button class="radio-button" onclick="playRadio(this, "https://classichitsradio.streamingmedia.it/play")">CLASSIC HITS RADIO Italia</button>
<button class="radio-button" onclick="playRadio(this, "https://stream.rds.radio/audio/rds.stream_aac64/chunklist.m3u8")">RDS 100% Grandi Successi</button>

</div>
<div id="playerContainer">
<audio id="audioPlayer" controls></audio><br>
<button id="stopBtn" onclick="stopRadio()">Stop</button>
<div id="debug" aria-hidden="true"></div>
</div>

<script>
const debugLog = (msg) => {{{{
  console.log("[RADIO]", msg);
  const d = document.getElementById('debug');
  if(d) {{{{ d.textContent = msg; d.style.opacity = "1"; setTimeout(() => {{{{ d.style.opacity = "0"; }}}}, 3000); }}}}
}}}}};

let activeButton = null;
let audio = document.getElementById('audioPlayer');
let hls = null;

function destroyHls() {{{{
  if(hls) {{{{ try {{{{ hls.destroy(); }}}} catch(e){{ console.warn(e); }} hls = null; }}}}
}}}}}

function playRadio(btn, url) {{{{
  debugLog("Play request: " + url);
  if(!url || url === "#") {{{{ alert("Streaming non disponibile per questa radio."); return; }}}}
  if(activeButton) activeButton.classList.remove('active');
  activeButton = btn;
  activeButton.classList.add('active');
  destroyHls();

  if(typeof Hls !== "undefined" && Hls.isSupported() && url.endsWith('.m3u8')) {{{{
    hls = new Hls();
    hls.on(Hls.Events.ERROR, function(event, data) {{{{
      console.warn("HLS error", data);
      if(data && data.fatal) {{{{
        destroyHls();
        audio.src = url;
        audio.play().catch(err => debugLog("Fallback native play failed: " + err));
      }}}}
    }}}});
    try {{{{
      hls.loadSource(url);
      hls.attachMedia(audio);
      hls.on(Hls.Events.MANIFEST_PARSED, () => audio.play().catch(err => debugLog("Play error: " + err)));
    }}}} catch(e) {{{{
      debugLog("Errore creazione Hls: " + e);
      audio.src = url;
      audio.play().catch(err => debugLog("Fallback native play failed: " + err));
    }}}}
    return;
  }}}}

  audio.src = url;
  audio.play().catch(err => {{{{
    debugLog("Play error native: " + err);
    if(typeof Hls !== "undefined" && url.endsWith('.m3u8') && Hls.isSupported()) {{{{
      debugLog("Riprovo con Hls.js");
      try {{{{
        hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(audio);
        hls.on(Hls.Events.MANIFEST_PARSED, () => audio.play().catch(e => debugLog("play error hls: " + e)));
      }}}} catch(err) {{{{
        debugLog("Errore creazione Hls (2): " + err);
      }}}}
    }}}}
  }}}});
}}}}}

function stopRadio() {{{{
  if(activeButton) activeButton.classList.remove('active');
  activeButton = null;
  if(audio) {{{{ try {{{{ audio.pause(); audio.removeAttribute('src'); audio.load(); }}}} catch(e){{ console.warn(e); }} }}}}
  destroyHls();
}}}}}
</script>
</body>
</html>